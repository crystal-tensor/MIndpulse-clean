"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[631],{7631:function(e,t,a){a.d(t,{default:function(){return D}});var s=a(7437),r=a(2265),l=a(6470),n=a(6687),o=a(5901),c=a(8159),i=a(6331),d=a(2087),m=a(588),x=a(3767),h=a(3905),u=a(4823),p=a(9152),g=a(3836),y=a(9581),b=a(2594),v=a(1601),j=a(36),f=a(6310),N=a(5945),w=a(7442),S=a(1442),k=a(301),_=a(7165),C=a(1994);function D(){var e,t,a,D,O,T,I,E,Z,M,P,J,L,R;let[H,A]=(0,r.useState)([]),[K,U]=(0,r.useState)(""),[z,F]=(0,r.useState)(!1),[W,q]=(0,r.useState)("knowledge-graph"),[B,G]=(0,r.useState)(!1),[Y,$]=(0,r.useState)({provider:"deepseek",apiKey:"",modelName:"deepseek-chat",baseUrl:"https://api.deepseek.com/v1",temperature:.7,contextWindow:4e3,streamingResponse:!1}),[Q,V]=(0,r.useState)([]),[X,ee]=(0,r.useState)(!1),[et,ea]=(0,r.useState)(!1),[es,er]=(0,r.useState)(!1),[el,en]=(0,r.useState)(""),[eo,ec]=(0,r.useState)(""),[ei,ed]=(0,r.useState)(""),[em,ex]=(0,r.useState)("local"),[eh,eu]=(0,r.useState)(null),[ep,eg]=(0,r.useState)([]),[ey,eb]=(0,r.useState)([]),[ev,ej]=(0,r.useState)(!1),[ef,eN]=(0,r.useState)({"knowledge-graph":"","thought-chain":"","cognitive-map":"","decision-model":""}),[ew,eS]=(0,r.useState)("both"),[ek,e_]=(0,r.useState)(50),[eC,eD]=(0,r.useState)({riskPreference:.5,quantumBackend:"IBM Quantum Simulator",language:"zh",emailNotification:!0,autoSave:!0,theme:"dark"}),[eO,eT]=(0,r.useState)({graphType:"2d",timeRange:"all",startDate:"",endDate:""}),[eI,eE]=(0,r.useState)({compareMode:"last",customStartDate:"",customEndDate:""}),[eZ,eM]=(0,r.useState)([]),[eP,eJ]=(0,r.useState)(!1),[eL,eR]=(0,r.useState)({message:"",type:"success",show:!1}),eH=(0,r.useRef)(null),eA=(0,r.useRef)(null),eK=(0,r.useRef)("user_".concat(Math.random().toString(36).substring(2,9)));(0,r.useEffect)(()=>{eB(),eQ(),e6(),eG(),e7(),setTimeout(()=>{let e="欢迎来到智核交互界面！我是您的AI认知探索伙伴，可以帮您分析问题、构建知识图谱、做出智能决策。请告诉我您想探讨的话题。";A([{role:"assistant",content:e,formatted_content:e9(e)}])},100)},[]);let[eU,ez]=(0,r.useState)(!0),[eF,eW]=(0,r.useState)(!1),eq=(0,r.useRef)(null);(0,r.useEffect)(()=>{if(eH.current&&eU){let e=eq.current;e&&e.scrollHeight-e.scrollTop-e.clientHeight<50&&requestAnimationFrame(()=>{e.scrollTo({top:e.scrollHeight,behavior:"smooth"})})}},[H,eU]);let eB=()=>{try{let e=localStorage.getItem("mindpulse-llm-settings");e&&$({...Y,...JSON.parse(e)});let t=localStorage.getItem("mindpulse-system-settings");t&&eD({...eC,...JSON.parse(t)})}catch(e){console.error("加载设置失败:",e)}},eG=()=>{try{let e=localStorage.getItem("mindpulse-save-location");e&&(eu(e),ex(e));let t=localStorage.getItem("mindpulse-pinned-conversations");t&&eg(JSON.parse(t))}catch(e){console.error("加载保存偏好失败:",e)}},eY=async()=>{if(!Y.apiKey){e8("请先配置API密钥","error");return}if(!Y.modelName){e8("请先选择模型","error");return}eJ(!0),e8("正在测试连接...","success");try{let t=await fetch("/api/mindpilot/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:Y.provider,apiKey:Y.apiKey,model:Y.modelName,baseUrl:Y.baseUrl})});if(t.ok){var e;let a=await t.json();e8("连接测试成功！模型：".concat((null===(e=a.details)||void 0===e?void 0:e.model)||Y.modelName),"success")}else{let e=await t.json(),a=e.details||e.error||"未知错误";e8("连接测试失败：".concat(a),"error")}}catch(e){console.error("测试连接失败:",e),e8("连接测试失败，请检查网络和设置","error")}finally{eJ(!1)}},e$=async()=>{if(!K.trim()||z)return;if(!Y.apiKey){e8("请先在设置中配置API密钥","error"),eS("settings");return}let e={role:"user",content:K};A(t=>[...t,e]),U(""),F(!0);try{let e=await fetch("/api/mindpilot/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:K,user_id:eK.current,model:Y.modelName,temperature:Y.temperature,stream:Y.streamingResponse,provider:Y.provider,apiKey:Y.apiKey,base_url:Y.baseUrl})});if(!e.ok){let t=await e.json();throw Error(t.error||"网络响应异常")}let t=await e.json(),a={role:"assistant",content:t.response,formatted_content:e9(t.response)};A(e=>[...e,a]),setTimeout(()=>e5("2d"),1e3)}catch(e){console.error("发送消息失败:",e),A(e=>[...e,{role:"assistant",content:"抱歉，处理您的消息时出现了错误。请重试。"}])}finally{F(!1)}},eQ=async()=>{try{let e=[];try{let t=await fetch("/api/mindpilot/conversations");t.ok&&(e=[...(await t.json()).conversations||[]])}catch(e){console.error("加载云端对话失败:",e)}try{let t=JSON.parse(localStorage.getItem("mindpulse-local-conversations")||"[]");e=[...e,...t]}catch(e){console.error("加载本地对话失败:",e)}e.sort((e,t)=>new Date(t.created_at).getTime()-new Date(e.created_at).getTime()),V(e)}catch(e){console.error("加载对话列表失败:",e)}},eV=()=>{var e;let t=(null===(e=H.find(e=>"user"===e.role))||void 0===e?void 0:e.content)||"",a="";if(t){let e=t.replace(/[，。！？；：""''（）【】\s]/g,"");a=e.length>15?e.substring(0,15)+"...":e||"新对话"}else a="新对话";let s=new Date,r=String(s.getMonth()+1).padStart(2,"0"),l=String(s.getDate()).padStart(2,"0"),n=String(s.getHours()).padStart(2,"0"),o=String(s.getMinutes()).padStart(2,"0"),c="".concat(r).concat(l).concat(n).concat(o);return"".concat(a,"_").concat(c)},eX=async(e,t)=>{try{let a=JSON.stringify({name:e,timestamp:new Date().toISOString(),messages:t.chat_history,user_id:t.user_id},null,2),s=new Blob([a],{type:"application/json"}),r=URL.createObjectURL(s),l=document.createElement("a");l.href=r,l.download="".concat(e.replace(/[^a-zA-Z0-9\u4e00-\u9fa5]/g,"_"),".json"),document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(r);let n=JSON.parse(localStorage.getItem("mindpulse-local-conversations")||"[]");return n.push({id:"local_".concat(Date.now()),name:e,created_at:new Date().toISOString(),message_count:t.chat_history.length,chat_history:t.chat_history,save_location:"local"}),localStorage.setItem("mindpulse-local-conversations",JSON.stringify(n)),!0}catch(e){return console.error("保存到本地文件失败:",e),!1}},e0=async()=>{if(null===eh){er(!0);return}let e=el.trim()||eV(),t={name:e,chat_history:H,user_id:eK.current,save_location:em};try{let a=!1;if("local"===em)(a=await eX(e,t))&&e8("对话已保存到本地文件","success");else if("cloud"===em)(a=(await fetch("/api/mindpilot/conversations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)&&e8("对话已保存到云端","success");else if("both"===em){let s=await eX(e,t),r=(await fetch("/api/mindpilot/conversations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok;s&&r?(e8("对话已保存到本地和云端","success"),a=!0):s?(e8("对话已保存到本地，云端保存失败","error"),a=!0):r&&(e8("对话已保存到云端，本地保存失败","error"),a=!0)}if(a)ee(!1),en(""),eQ();else throw Error("保存失败")}catch(e){console.error("保存对话失败:",e),e8("保存对话失败","error")}},e4=async e=>{try{if(e.startsWith("local_")){let t=JSON.parse(localStorage.getItem("mindpulse-local-conversations")||"[]").find(t=>t.id===e);if(t){let e=(t.chat_history||[]).map(e=>({...e,formatted_content:"assistant"===e.role?e9(e.content):e.content}));A(e),e8("本地对话已加载","success");return}}let t=await fetch("/api/mindpilot/conversations?id=".concat(e));if(t.ok){let e=((await t.json()).chat_history||[]).map(e=>({...e,formatted_content:"assistant"===e.role?e9(e.content):e.content}));A(e),e8("对话已加载","success")}}catch(e){console.error("加载对话失败:",e),e8("加载对话失败","error")}},e2=e=>{let t=ep.includes(e)?ep.filter(t=>t!==e):[...ep,e];eg(t),localStorage.setItem("mindpulse-pinned-conversations",JSON.stringify(t)),e8(ep.includes(e)?"已取消置顶":"已置顶对话","success")},e3=async e=>{if(confirm("确定要删除这个对话吗？"))try{if(e.startsWith("local_")){let t=JSON.parse(localStorage.getItem("mindpulse-local-conversations")||"[]").filter(t=>t.id!==e);localStorage.setItem("mindpulse-local-conversations",JSON.stringify(t)),e8("本地对话已删除","success")}else if((await fetch("/api/mindpilot/conversations",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})})).ok)e8("对话已删除","success");else throw Error("删除云端对话失败");let t=ep.filter(t=>t!==e);eg(t),localStorage.setItem("mindpulse-pinned-conversations",JSON.stringify(t)),eQ()}catch(e){console.error("删除对话失败:",e),e8("删除对话失败","error")}},e5=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"2d";if(0!==H.length)try{let a=[...H];try{let e=JSON.parse(localStorage.getItem("mindpulse-local-conversations")||"[]"),t=new Date;t.setMonth(t.getMonth()-6),e.forEach(e=>{new Date(e.created_at)>=t&&e.chat_history&&(a=[...a,...e.chat_history])})}catch(e){console.log("获取本地对话历史失败:",e)}try{let e=await fetch("/api/mindpilot/conversations");if(e.ok){var t;let s=await e.json(),r=new Date;r.setMonth(r.getMonth()-6),null===(t=s.conversations)||void 0===t||t.forEach(e=>{new Date(e.created_at)>=r&&e.chat_history&&(a=[...a,...e.chat_history])})}}catch(e){console.log("获取云端对话历史失败:",e)}let s=a;"custom"===eO.timeRange&&eO.startDate&&eO.endDate,console.log("准备生成".concat(e.toUpperCase(),"图谱，处理").concat(s.length,"条消息"));let r=await fetch("/api/mindpilot/generate-graph",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:s,graph_type:e,user_id:eK.current,time_range:"custom"===eO.timeRange?{start:eO.startDate,end:eO.endDate}:null})});if(r.ok){let t=await r.json();console.log("图谱生成成功:",t),"2d"===e?eN(e=>({...e,"knowledge-graph":t.graph_url})):"3d"===e&&eN(e=>({...e,"cognitive-map":t.graph_url}));let a={...t.graph_data,timestamp:new Date().toISOString(),type:e};eM(e=>{let t=[...e,a];try{localStorage.setItem("mindpulse-historical-graphs",JSON.stringify(t))}catch(e){console.error("保存历史图谱数据失败:",e)}return t}),e8("".concat(e.toUpperCase(),"图谱已生成，处理了").concat(t.messages_processed,"条消息"),"success")}else{let e=await r.json();throw Error(e.error||"生成图谱失败")}}catch(e){console.error("生成图谱失败:",e),e8("生成图谱失败: "+e.message,"error")}},e1=async e=>{var t;let a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(!a)return;ej(!0);let s=new FormData;s.append("file",a),s.append("user_id",eK.current);try{let e=await fetch("/api/mindpilot/upload",{method:"POST",body:s});if(e.ok){let t=await e.json();eb(e=>[...e,t.file_info]),e8("文件上传成功","success"),t.summary&&A(e=>[...e,{role:"assistant",content:'文件 "'.concat(a.name,'" 已上传。文件摘要：\n\n').concat(t.summary)}])}else throw Error("上传失败")}catch(e){console.error("文件上传失败:",e),e8("文件上传失败","error")}finally{ej(!1),e.target&&(e.target.value="")}},e6=async()=>{try{let e=await fetch("/api/mindpilot/files?user_id=".concat(eK.current));if(e.ok){let t=await e.json();eb(t.files||[])}}catch(e){console.error("加载文件列表失败:",e)}},e7=()=>{try{let e=localStorage.getItem("mindpulse-historical-graphs");e&&eM(JSON.parse(e))}catch(e){console.error("加载历史图谱数据失败:",e)}},e8=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";console.log("".concat(t,": ").concat(e)),eR({message:e,type:t,show:!0}),setTimeout(()=>{eR(e=>({...e,show:!1}))},3e3)},e9=e=>{if(!e)return e;let t=[],a=e.replace(/```[\s\S]*?```/g,e=>(t.push(e),"__CODE_BLOCK_".concat(t.length-1,"__"))),s=[],r=(a=a.replace(/`[^`]+`/g,e=>(s.push(e),"__INLINE_CODE_".concat(s.length-1,"__")))).split(/([。！？；\n]{1,2})/).filter(e=>""!==e.trim()),l=[],n="",o=0;for(let e=0;e<r.length;e++){let t=r[e].trim();t&&(/^[。！？；\n]+$/.test(t)?(n+=t,(++o>=2||t.includes("\n"))&&(n.trim()&&l.push(n.trim()),n="",o=0)):n.length>120?(n.trim()&&l.push(n.trim()),n=t,o=0):n+=t)}n.trim()&&l.push(n.trim());let c=l.map(e=>{if(/^\d+[\.、]\s/.test(e))return'<div class="mb-2 pl-4 border-l-2 border-cyan-400/30">'.concat(e,"</div>");if(/^[-*•]\s/.test(e))return'<div class="mb-2 pl-4 border-l-2 border-purple-400/30">'.concat(e,"</div>");if(/^#{1,6}\s/.test(e)){var t;let a=(null===(t=e.match(/^(#{1,6})/))||void 0===t?void 0:t[1].length)||1,s=e.replace(/^#{1,6}\s/,"");return"<h".concat(Math.min(a+1,6),' class="text-lg font-semibold text-cyan-400 mt-4 mb-2">').concat(s,"</h").concat(Math.min(a+1,6),">")}return'<p class="mb-3 leading-relaxed">'.concat(e,"</p>")}).join("");return s.forEach((e,t)=>{c=c.replace("__INLINE_CODE_".concat(t,"__"),'<code class="bg-gray-700/50 px-2 py-1 rounded text-cyan-300 text-sm">'.concat(e.slice(1,-1),"</code>"))}),t.forEach((e,t)=>{var a;null===(a=e.match(/```(\w+)/))||void 0===a||a[1];let s=e.replace(/```\w*\n?/,"").replace(/```$/,"");c=c.replace("__CODE_BLOCK_".concat(t,"__"),'<pre class="bg-gray-800/50 border border-gray-600/50 rounded-lg p-4 mt-4 mb-4 overflow-x-auto"><code class="text-green-300 text-sm">'.concat(s,"</code></pre>"))}),c},te=async()=>{if(eZ.length<2){e8("需要至少2个图谱才能进行对比分析","error");return}try{var e,t,a,s,r,l,n,o;e8("正在分析知识成长...","success");let c=eZ[eZ.length-1],i="last"===eI.compareMode?eZ[eZ.length-2]:eZ.find(e=>{if(!eI.customStartDate||!eI.customEndDate)return!1;let t=new Date(e.timestamp),a=new Date(eI.customStartDate),s=new Date(eI.customEndDate);return t>=a&&t<=s})||eZ[eZ.length-2],d=((null===(e=c.metadata)||void 0===e?void 0:e.node_count)||0)-((null===(t=i.metadata)||void 0===t?void 0:t.node_count)||0),m=((null===(a=c.metadata)||void 0===a?void 0:a.edge_count)||0)-((null===(s=i.metadata)||void 0===s?void 0:s.edge_count)||0),x=d+m,h="请基于以下知识图谱数据生成一份详细的成长对比分析报告：\n\n当前图谱数据：\n- 节点数量：".concat((null===(r=c.metadata)||void 0===r?void 0:r.node_count)||0,"\n- 边数量：").concat((null===(l=c.metadata)||void 0===l?void 0:l.edge_count)||0,"\n- 生成时间：").concat(new Date(c.timestamp).toLocaleString(),"\n\n对比图谱数据：\n- 节点数量：").concat((null===(n=i.metadata)||void 0===n?void 0:n.node_count)||0,"\n- 边数量：").concat((null===(o=i.metadata)||void 0===o?void 0:o.edge_count)||0,"\n- 生成时间：").concat(new Date(i.timestamp).toLocaleString(),"\n\n变化情况：\n- 节点增长：").concat(d>0?"+":"").concat(d,"\n- 边增长：").concat(m>0?"+":"").concat(m,"\n- 复杂度变化：").concat(x>0?"提升":x<0?"简化":"保持稳定","\n\n请从以下几个维度进行分析：\n1. 知识结构的变化和发展\n2. 学习深度和广度的变化\n3. 知识连接性的改善\n4. 认知能力的提升\n5. 未来学习建议\n\n请用中文回答，并提供具体的洞察和建议。"),u=await fetch("/api/mindpilot/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:h,user_id:eK.current,model:Y.modelName,temperature:.7,stream:!1,provider:Y.provider,apiKey:Y.apiKey,base_url:Y.baseUrl})});if(!u.ok)throw Error("分析请求失败");let p=await u.json(),g={role:"assistant",content:p.response,formatted_content:e9(p.response)};A(e=>[...e,{role:"user",content:"请为我生成知识成长对比分析报告"},g]),e8("成长对比分析已生成","success")}catch(e){console.error("生成成长分析失败:",e),e8("生成分析失败: "+e.message,"error")}},tt=e=>({"knowledge-graph":l.Z,"thought-chain":n.Z,"cognitive-map":o.Z,"decision-model":c.Z})[e]||i.Z;return(0,s.jsxs)("div",{className:"h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 text-white overflow-hidden relative",children:[(0,s.jsxs)("div",{className:"h-16 bg-gray-800/50 backdrop-blur-xl border-b border-cyan-500/20 flex items-center justify-between px-6",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-cyan-400 to-purple-500 rounded-lg flex items-center justify-center",children:(0,s.jsx)(d.Z,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg font-bold bg-gradient-to-r from-cyan-400 to-purple-400 bg-clip-text text-transparent",children:"智核交互"}),(0,s.jsx)("p",{className:"text-xs text-gray-400",children:"AI Core Interface"})]})]}),(0,s.jsx)("nav",{className:"flex items-center space-x-1",children:[{id:"both",label:"双栏",icon:m.Z},{id:"chat",label:"对话",icon:x.Z},{id:"graph",label:"图谱",icon:h.Z},{id:"growth",label:"成长",icon:u.Z},{id:"settings",label:"设置",icon:p.Z}].map(e=>{let{id:t,label:a,icon:r}=e;return(0,s.jsxs)("button",{onClick:()=>eS(t),className:(0,C.W)("flex items-center space-x-2 px-4 py-2 rounded-lg transition-all",ew===t?"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 border border-cyan-500/50 text-cyan-400":"bg-gray-700/30 hover:bg-gray-600/30 text-gray-400 hover:text-white"),children:[(0,s.jsx)(r,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm",children:a})]},t)})}),(0,s.jsx)("button",{onClick:()=>eS("settings"),className:(0,C.W)("p-2 rounded-lg transition-colors","settings"===ew?"bg-cyan-500/20 text-cyan-400":"hover:bg-gray-700/50 text-gray-400 hover:text-white"),children:(0,s.jsx)(p.Z,{className:"w-5 h-5"})})]}),(0,s.jsxs)("div",{className:"flex h-[calc(100vh-4rem)]",children:[(0,s.jsxs)("div",{className:"w-80 bg-gray-800/30 backdrop-blur-xl border-r border-gray-700/50 flex flex-col",children:[(0,s.jsx)("div",{className:"p-4 border-b border-gray-700/50",children:(0,s.jsxs)("button",{onClick:()=>{let e="欢迎来到智核交互界面！我是您的AI认知探索伙伴，可以帮您分析问题、构建知识图谱、做出智能决策。请告诉我您想探讨的话题。";A([{role:"assistant",content:e,formatted_content:e9(e)}])},className:"w-full flex items-center space-x-2 px-4 py-3 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg transition-all",children:[(0,s.jsx)(g.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:"新建对话"})]})}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-4 space-y-2",children:[...Q].sort((e,t)=>{let a=ep.includes(e.id),s=ep.includes(t.id);return a&&!s?-1:!a&&s?1:new Date(t.created_at).getTime()-new Date(e.created_at).getTime()}).map(e=>{let t=ep.includes(e.id);return(0,s.jsxs)("div",{className:"group rounded-lg p-3 transition-all cursor-pointer ".concat(t?"bg-cyan-500/10 border border-cyan-500/30 hover:bg-cyan-500/20":"bg-gray-700/30 hover:bg-gray-600/30"),onClick:()=>e4(e.id),children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[t&&(0,s.jsx)("div",{className:"w-2 h-2 bg-cyan-400 rounded-full flex-shrink-0"}),(0,s.jsx)("h5",{className:"text-sm font-medium text-white truncate",children:e.name})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),e2(e.id)},className:"p-1 rounded transition-colors ".concat(t?"bg-cyan-500/20 text-cyan-400":"hover:bg-cyan-500/20 text-gray-400 hover:text-cyan-400"),title:t?"取消置顶":"置顶对话",children:(0,s.jsx)(y.Z,{className:"w-3 h-3"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),ec(e.id),ed(e.name),ea(!0)},className:"p-1 hover:bg-yellow-500/20 rounded text-yellow-400",title:"重命名",children:(0,s.jsx)(b.Z,{className:"w-3 h-3"})}),(0,s.jsx)("button",{onClick:t=>{t.stopPropagation(),e3(e.id)},className:"p-1 hover:bg-red-500/20 rounded text-red-400",title:"删除",children:(0,s.jsx)(v.Z,{className:"w-3 h-3"})})]})]}),(0,s.jsxs)("div",{className:"text-xs text-gray-400",children:[e.message_count," 条消息 • ",new Date(e.created_at).toLocaleDateString(),t&&(0,s.jsx)("span",{className:"ml-2 text-cyan-400",children:"• 已置顶"})]})]},e.id)})}),(0,s.jsxs)("div",{className:"p-4 border-t border-gray-700/50 space-y-2",children:[(0,s.jsxs)("button",{onClick:()=>ee(!0),className:"w-full flex items-center space-x-2 px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-all text-sm",children:[(0,s.jsx)(y.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"保存对话"})]}),(0,s.jsxs)("button",{onClick:()=>{var e;return null===(e=eA.current)||void 0===e?void 0:e.click()},className:"w-full flex items-center space-x-2 px-3 py-2 bg-gray-700/50 hover:bg-gray-600/50 rounded-lg transition-all text-sm",children:[(0,s.jsx)(j.Z,{className:"w-4 h-4"}),(0,s.jsx)("span",{children:"上传文件"}),ev&&(0,s.jsx)("div",{className:"w-3 h-3 border-2 border-purple-400 border-t-transparent rounded-full animate-spin"})]})]})]}),(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:["settings"===ew&&(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-cyan-400 mb-6",children:"大模型设置"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"模型提供商"}),(0,s.jsxs)("select",{value:Y.provider,onChange:e=>$(t=>({...t,provider:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",children:[(0,s.jsx)("option",{value:"deepseek",children:"DeepSeek"}),(0,s.jsx)("option",{value:"openai",children:"OpenAI"}),(0,s.jsx)("option",{value:"claude",children:"Claude"}),(0,s.jsx)("option",{value:"gemini",children:"Gemini"}),(0,s.jsx)("option",{value:"tongyi",children:"通义千问"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"模型选择"}),(0,s.jsx)("select",{value:Y.modelName,onChange:e=>$(t=>({...t,modelName:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",children:(({deepseek:[{value:"deepseek-chat",label:"DeepSeek Chat"},{value:"deepseek-coder",label:"DeepSeek Coder"}],openai:[{value:"gpt-4",label:"GPT-4"},{value:"gpt-4o-mini",label:"GPT-4O Mini"},{value:"gpt-3.5-turbo",label:"GPT-3.5 Turbo"}],claude:[{value:"claude-3-opus",label:"Claude 3 Opus"},{value:"claude-3-haiku",label:"Claude 3 Haiku"}],gemini:[{value:"gemini-pro",label:"Gemini Pro"}],tongyi:[{value:"qwen-max",label:"通义千问 Max"},{value:"qwen-plus",label:"通义千问 Plus"}]})[Y.provider]||[]).map(e=>(0,s.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"API密钥"}),(0,s.jsx)("input",{type:"password",value:Y.apiKey,onChange:e=>$(t=>({...t,apiKey:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",placeholder:"输入API密钥"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-medium text-purple-400 mb-2",children:["温度设置 (",Y.temperature,")"]}),(0,s.jsx)("input",{type:"range",min:"0",max:"2",step:"0.1",value:Y.temperature,onChange:e=>$(t=>({...t,temperature:parseFloat(e.target.value)})),className:"w-full"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"基础URL"}),(0,s.jsx)("input",{type:"text",value:Y.baseUrl,onChange:e=>$(t=>({...t,baseUrl:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",placeholder:"可选，自定义API地址"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"streaming",checked:Y.streamingResponse,onChange:e=>$(t=>({...t,streamingResponse:e.target.checked})),className:"w-4 h-4"}),(0,s.jsx)("label",{htmlFor:"streaming",className:"text-sm text-gray-300",children:"流式响应"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-4 mt-6",children:[(0,s.jsxs)("button",{onClick:eY,disabled:eP,className:"px-6 py-2 bg-gradient-to-r from-green-500 to-blue-500 hover:from-green-400 hover:to-blue-400 disabled:from-gray-500 disabled:to-gray-600 rounded-lg font-medium transition-all flex items-center space-x-2",children:[eP&&(0,s.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,s.jsx)("span",{children:eP?"测试中...":"测试连接"})]}),(0,s.jsx)("button",{onClick:()=>{try{localStorage.setItem("mindpulse-llm-settings",JSON.stringify(Y)),e8("设置已保存","success")}catch(e){console.error("保存设置失败:",e),e8("保存设置失败","error")}},className:"px-6 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg font-medium transition-all",children:"保存设置"})]})]}),(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-cyan-400 mb-6",children:"系统设置"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"font-medium text-purple-400 mb-2",children:["风险偏好 (",eC.riskPreference.toFixed(1),")"]}),(0,s.jsx)("input",{type:"range",min:"0",max:"1",step:"0.1",value:eC.riskPreference,onChange:e=>eD(t=>({...t,riskPreference:parseFloat(e.target.value)})),className:"w-full"}),(0,s.jsxs)("div",{className:"flex justify-between text-xs text-gray-400 mt-1",children:[(0,s.jsx)("span",{children:"保守"}),(0,s.jsx)("span",{children:"激进"})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"语言设置"}),(0,s.jsxs)("select",{value:eC.language,onChange:e=>eD(t=>({...t,language:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",children:[(0,s.jsx)("option",{value:"zh",children:"中文"}),(0,s.jsx)("option",{value:"en",children:"English"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"主题设置"}),(0,s.jsxs)("select",{value:eC.theme,onChange:e=>eD(t=>({...t,theme:e.target.value})),className:"w-full bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2",children:[(0,s.jsx)("option",{value:"dark",children:"深色模式"}),(0,s.jsx)("option",{value:"light",children:"浅色模式"}),(0,s.jsx)("option",{value:"auto",children:"跟随系统"})]})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"emailNotification",checked:eC.emailNotification,onChange:e=>eD(t=>({...t,emailNotification:e.target.checked})),className:"w-4 h-4"}),(0,s.jsx)("label",{htmlFor:"emailNotification",className:"text-sm text-gray-300",children:"邮件通知"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("input",{type:"checkbox",id:"autoSave",checked:eC.autoSave,onChange:e=>eD(t=>({...t,autoSave:e.target.checked})),className:"w-4 h-4"}),(0,s.jsx)("label",{htmlFor:"autoSave",className:"text-sm text-gray-300",children:"自动保存"})]})]})]})]}),(0,s.jsx)("div",{className:"flex justify-end mt-6",children:(0,s.jsx)("button",{onClick:()=>{try{localStorage.setItem("mindpulse-system-settings",JSON.stringify(eC)),e8("系统设置已保存","success")}catch(e){console.error("保存系统设置失败:",e),e8("保存系统设置失败","error")}},className:"px-6 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg font-medium transition-all",children:"保存系统设置"})})]}),(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-cyan-400 mb-6",children:"数据管理"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"对话数据"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-3",children:["当前共有 ",Q.length," 个对话记录"]}),(0,s.jsx)("button",{className:"w-full px-4 py-2 bg-blue-600/20 hover:bg-blue-600/30 border border-blue-500/30 rounded-lg text-sm transition-colors",children:"导出对话数据"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"图谱数据"}),(0,s.jsxs)("p",{className:"text-sm text-gray-400 mb-3",children:["当前共有 ",eZ.length," 个图谱记录"]}),(0,s.jsx)("button",{className:"w-full px-4 py-2 bg-green-600/20 hover:bg-green-600/30 border border-green-500/30 rounded-lg text-sm transition-colors",children:"导出图谱数据"})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"清理数据"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-3",children:"清理超过30天的临时数据"}),(0,s.jsx)("button",{className:"w-full px-4 py-2 bg-yellow-600/20 hover:bg-yellow-600/30 border border-yellow-500/30 rounded-lg text-sm transition-colors",children:"清理临时文件"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium text-purple-400 mb-2",children:"重置数据"}),(0,s.jsx)("p",{className:"text-sm text-gray-400 mb-3",children:"删除所有本地数据（不可恢复）"}),(0,s.jsx)("button",{onClick:()=>{confirm("确定要重置所有数据吗？此操作不可恢复。")&&(localStorage.clear(),window.location.reload())},className:"w-full px-4 py-2 bg-red-600/20 hover:bg-red-600/30 border border-red-500/30 rounded-lg text-sm transition-colors",children:"重置所有数据"})]})]})]})]})]})}),"growth"===ew&&(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsx)("div",{className:"glassmorphism rounded-2xl p-6",children:(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-cyan-400",children:"知识成长对比"}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("select",{value:eI.compareMode,onChange:e=>eE(t=>({...t,compareMode:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-2 text-sm",children:[(0,s.jsx)("option",{value:"last",children:"与上次对话对比"}),(0,s.jsx)("option",{value:"custom",children:"自定义时间段对比"})]}),"custom"===eI.compareMode&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"date",value:eI.customStartDate,onChange:e=>eE(t=>({...t,customStartDate:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-2 py-1 text-sm",placeholder:"开始日期"}),(0,s.jsx)("span",{className:"text-gray-400",children:"至"}),(0,s.jsx)("input",{type:"date",value:eI.customEndDate,onChange:e=>eE(t=>({...t,customEndDate:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-2 py-1 text-sm",placeholder:"结束日期"})]}),(0,s.jsx)("button",{onClick:te,disabled:eZ.length<2,className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 disabled:from-gray-600 disabled:to-gray-700 rounded-lg text-sm font-medium transition-all",children:"生成对比分析"})]})]})}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-purple-400",children:"对话数量"}),(0,s.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCAC"})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-white mb-2",children:Q.length}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:Q.length>0?"较上次增长 ".concat(Math.max(0,Q.length-1)," 个"):"开始你的第一次对话"})]}),(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-purple-400",children:"知识节点"}),(0,s.jsx)("div",{className:"text-2xl",children:"\uD83E\uDDE0"})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-white mb-2",children:eZ.reduce((e,t)=>{var a;return e+((null===(a=t.metadata)||void 0===a?void 0:a.node_count)||0)},0)}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"总计知识节点数量"})]}),(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-purple-400",children:"图谱生成"}),(0,s.jsx)("div",{className:"text-2xl",children:"\uD83D\uDCCA"})]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-white mb-2",children:eZ.length}),(0,s.jsx)("div",{className:"text-sm text-gray-400",children:"已生成图谱数量"})]})]}),(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-cyan-400 mb-6",children:"知识成长趋势"}),eZ.length>=2?(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-purple-400",children:"当前知识图谱"}),eZ.length>0&&(0,s.jsx)("div",{className:"bg-gray-900/50 rounded-xl p-4 aspect-square",children:(0,s.jsx)("iframe",{src:(null===(e=eZ[eZ.length-1])||void 0===e?void 0:e.graph_url)||"",title:"当前知识图谱",className:"w-full h-full border-0 rounded-lg",style:{minHeight:"400px"}})}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["节点数: ",(null===(a=eZ[eZ.length-1])||void 0===a?void 0:null===(t=a.metadata)||void 0===t?void 0:t.node_count)||0]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h4",{className:"text-lg font-semibold text-purple-400",children:"last"===eI.compareMode?"上次知识图谱":"对比期间图谱"}),eZ.length>1&&(0,s.jsx)("div",{className:"bg-gray-900/50 rounded-xl p-4 aspect-square",children:(0,s.jsx)("iframe",{src:(null===(D=eZ[eZ.length-2])||void 0===D?void 0:D.graph_url)||"",title:"对比知识图谱",className:"w-full h-full border-0 rounded-lg",style:{minHeight:"400px"}})}),(0,s.jsxs)("div",{className:"text-sm text-gray-400",children:["节点数: ",(null===(T=eZ[eZ.length-2])||void 0===T?void 0:null===(O=T.metadata)||void 0===O?void 0:O.node_count)||0]})]})]}):(0,s.jsxs)("div",{className:"text-center py-12",children:[(0,s.jsx)("div",{className:"text-6xl mb-4",children:"\uD83D\uDCC8"}),(0,s.jsx)("h4",{className:"text-lg font-medium text-gray-300 mb-2",children:"等待更多数据"}),(0,s.jsx)("p",{className:"text-gray-500",children:"需要至少2个图谱才能进行成长对比分析"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"继续对话以生成更多知识图谱"})]})]}),eZ.length>=2&&(0,s.jsxs)("div",{className:"glassmorphism rounded-2xl p-6",children:[(0,s.jsx)("h3",{className:"text-xl font-bold text-cyan-400 mb-6",children:"成长洞察"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),(0,s.jsxs)("span",{className:"text-sm text-gray-300",children:["知识节点增长: +",Math.max(0,((null===(E=eZ[eZ.length-1])||void 0===E?void 0:null===(I=E.metadata)||void 0===I?void 0:I.node_count)||0)-((null===(M=eZ[eZ.length-2])||void 0===M?void 0:null===(Z=M.metadata)||void 0===Z?void 0:Z.node_count)||0))]})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded-full"}),(0,s.jsxs)("span",{className:"text-sm text-gray-300",children:["连接关系增长: +",Math.max(0,((null===(J=eZ[eZ.length-1])||void 0===J?void 0:null===(P=J.metadata)||void 0===P?void 0:P.edge_count)||0)-((null===(R=eZ[eZ.length-2])||void 0===R?void 0:null===(L=R.metadata)||void 0===L?void 0:L.edge_count)||0))]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-purple-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"图谱复杂度提升"})]}),(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-cyan-500 rounded-full"}),(0,s.jsx)("span",{className:"text-sm text-gray-300",children:"知识结构优化"})]})]})]})]})]})}),("both"===ew||"chat"===ew||"graph"===ew)&&(0,s.jsxs)("div",{className:"flex-1 flex flex-col min-h-0",children:[("both"===ew||"chat"===ew)&&(0,s.jsxs)("div",{className:"bg-gray-800/30 backdrop-blur-xl border-b border-gray-700/50 flex flex-col min-h-0",style:{height:"chat"===ew?"100%":"".concat(ek,"%"),minHeight:"both"===ew?"300px":"auto"},children:[(0,s.jsxs)("div",{className:"flex-1 relative min-h-0",children:[(0,s.jsxs)("div",{ref:eq,className:"absolute inset-0 overflow-y-auto p-6 space-y-4 scroll-smooth",onScroll:e=>{let t=e.currentTarget,a=t.scrollHeight-t.scrollTop-t.clientHeight<50;!a&&eU?(ez(!1),eW(!0)):a&&!eU&&(ez(!0),eW(!1))},children:[H.map((e,t)=>(0,s.jsx)("div",{className:(0,C.W)("flex","user"===e.role?"justify-end":"justify-start"),children:(0,s.jsx)("div",{className:(0,C.W)("max-w-[80%] rounded-2xl px-6 py-4 shadow-lg","user"===e.role?"bg-gradient-to-r from-cyan-500 to-purple-500 text-white":"bg-gray-700/50 backdrop-blur-xl border border-gray-600/50 text-gray-100"),children:(0,s.jsx)("div",{dangerouslySetInnerHTML:{__html:e.formatted_content||e.content}})})},t)),z&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"bg-gray-700/50 backdrop-blur-xl border border-gray-600/50 rounded-2xl px-6 py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-cyan-400 rounded-full animate-pulse"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-purple-400 rounded-full animate-pulse delay-100"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-yellow-400 rounded-full animate-pulse delay-200"}),(0,s.jsx)("span",{className:"text-gray-300 ml-2",children:"AI正在思考..."})]})})}),(0,s.jsx)("div",{ref:eH})]}),eF&&(0,s.jsx)("button",{onClick:()=>{eq.current&&(eq.current.scrollTo({top:eq.current.scrollHeight,behavior:"smooth"}),ez(!0),eW(!1))},className:"absolute bottom-4 right-4 bg-cyan-500 hover:bg-cyan-400 text-white rounded-full p-3 shadow-lg transition-all z-10 animate-bounce",title:"滚动到最新消息",children:(0,s.jsx)(f.Z,{className:"w-5 h-5 rotate-90"})})]}),(0,s.jsx)("div",{className:"p-6 border-t border-gray-700/50",children:(0,s.jsxs)("div",{className:"flex space-x-4",children:[(0,s.jsx)("div",{className:"flex-1 relative",children:(0,s.jsx)("input",{type:"text",value:K,onChange:e=>U(e.target.value),onKeyPress:e=>"Enter"===e.key&&e$(),placeholder:"探索你的认知边界，输入任何想法...",disabled:z,className:"w-full bg-gray-700/50 backdrop-blur-xl border border-gray-600/50 rounded-2xl px-6 py-4 text-white placeholder-gray-400 focus:border-cyan-500/50 focus:ring-2 focus:ring-cyan-500/20 transition-all"})}),(0,s.jsx)("button",{onClick:e$,disabled:z||!K.trim(),className:"bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 disabled:from-gray-600 disabled:to-gray-700 rounded-2xl px-6 py-4 text-white transition-all shadow-lg",children:z?(0,s.jsx)(N.Z,{className:"w-6 h-6"}):(0,s.jsx)(w.Z,{className:"w-6 h-6"})})]})})]}),"both"===ew&&(0,s.jsx)("div",{className:"h-2 bg-gray-700/50 cursor-row-resize hover:bg-cyan-500/30 transition-colors relative group",onMouseDown:e=>{let t=e.clientY,a=e=>{e_(Math.max(20,Math.min(80,ek+(e.clientY-t)/(window.innerHeight-200)*100)))},s=()=>{document.removeEventListener("mousemove",a),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",a),document.addEventListener("mouseup",s)},children:(0,s.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,s.jsx)("div",{className:"w-12 h-1 bg-gray-500 rounded-full group-hover:bg-cyan-400 transition-colors"})})}),("both"===ew||"graph"===ew)&&(0,s.jsxs)("div",{className:"bg-gray-800/30 backdrop-blur-xl flex flex-col",style:{height:"graph"===ew?"100%":"".concat(100-ek,"%"),minHeight:"both"===ew?"300px":"auto"},children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-700/50",children:[(0,s.jsx)("div",{className:"flex space-x-1",children:Object.keys(ef).map(e=>{let t=tt(e);return(0,s.jsxs)("button",{onClick:()=>q(e),className:(0,C.W)("flex items-center space-x-2 px-4 py-2 rounded-lg transition-all",W===e?"bg-gradient-to-r from-cyan-500/20 to-purple-500/20 border border-cyan-500/50 text-cyan-400":"bg-gray-700/30 hover:bg-gray-600/30 text-gray-400 hover:text-white"),children:[(0,s.jsx)(t,{className:"w-4 h-4"}),(0,s.jsx)("span",{className:"text-sm",children:{"knowledge-graph":"2D知识图谱","thought-chain":"思维链","cognitive-map":"3D认知图谱","decision-model":"决策模型"}[e]})]},e)})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("button",{onClick:()=>{eT(e=>({...e,graphType:"2d"})),q("knowledge-graph")},className:"px-3 py-1 rounded-lg text-sm transition-all ".concat("2d"===eO.graphType?"bg-cyan-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"2D图谱"}),(0,s.jsx)("button",{onClick:()=>{eT(e=>({...e,graphType:"3d"})),q("cognitive-map")},className:"px-3 py-1 rounded-lg text-sm transition-all ".concat("3d"===eO.graphType?"bg-purple-500 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:"3D图谱"})]}),(0,s.jsxs)("select",{value:eO.timeRange,onChange:e=>eT(t=>({...t,timeRange:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-3 py-1 text-sm",children:[(0,s.jsx)("option",{value:"all",children:"全部对话"}),(0,s.jsx)("option",{value:"custom",children:"自定义时间"})]}),"custom"===eO.timeRange&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("input",{type:"date",value:eO.startDate,onChange:e=>eT(t=>({...t,startDate:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-2 py-1 text-sm"}),(0,s.jsx)("span",{className:"text-gray-400",children:"至"}),(0,s.jsx)("input",{type:"date",value:eO.endDate,onChange:e=>eT(t=>({...t,endDate:e.target.value})),className:"bg-gray-800/50 border border-gray-600 rounded-lg px-2 py-1 text-sm"})]}),(0,s.jsx)("button",{onClick:()=>e5(eO.graphType),className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg text-sm font-medium transition-all",children:"3d"===eO.graphType?"生成3D图谱":"重新生成"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:ef[W]?(0,s.jsx)("iframe",{src:ef[W],title:"".concat(W," visualization"),className:"w-full h-full border-0 rounded-lg",style:{minHeight:"500px"}}):(0,s.jsx)("div",{className:"h-full flex items-center justify-center p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-24 h-24 bg-gradient-to-br from-cyan-400/20 to-purple-500/20 rounded-2xl flex items-center justify-center mb-4 mx-auto",children:(0,s.jsx)(i.Z,{className:"w-12 h-12 text-gray-400"})}),(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-300 mb-2",children:"等待数据生成"}),(0,s.jsx)("p",{className:"text-gray-500",children:"开始对话后将自动生成2D知识图谱"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:'点击"生成3D图谱"按钮生成三维图谱'})]})})})]})]})]})]}),(0,s.jsx)("input",{ref:eA,type:"file",onChange:e1,style:{display:"none"},accept:".txt,.md,.pdf,.doc,.docx"}),X&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gray-800 border border-cyan-500/30 rounded-2xl p-6 w-96 shadow-2xl",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"保存对话"}),(0,s.jsx)("input",{type:"text",value:el,onChange:e=>en(e.target.value),placeholder:"输入对话名称...",className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white mb-4"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>ee(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded-lg text-white transition-colors",children:"取消"}),(0,s.jsx)("button",{onClick:e0,className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg text-white transition-colors",children:"保存"})]})]})}),et&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gray-800 border border-cyan-500/30 rounded-2xl p-6 w-96 shadow-2xl",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"重命名对话"}),(0,s.jsx)("input",{type:"text",value:ei,onChange:e=>ed(e.target.value),className:"w-full bg-gray-700 border border-gray-600 rounded-lg px-3 py-2 text-white mb-4"}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>ea(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded-lg text-white transition-colors",children:"取消"}),(0,s.jsx)("button",{onClick:()=>{ea(!1)},className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg text-white transition-colors",children:"确定"})]})]})}),es&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50",children:(0,s.jsxs)("div",{className:"bg-gray-800 border border-cyan-500/30 rounded-2xl p-6 w-96 shadow-2xl",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-white mb-4",children:"选择保存位置"}),(0,s.jsx)("p",{className:"text-gray-300 text-sm mb-6",children:"首次保存对话，请选择默认保存位置。此设置将应用于以后的所有对话保存。"}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)("label",{className:"flex items-center space-x-3 p-3 bg-gray-700/30 rounded-lg cursor-pointer hover:bg-gray-700/50 transition-colors",children:[(0,s.jsx)("input",{type:"radio",name:"saveLocation",value:"local",checked:"local"===em,onChange:e=>ex(e.target.value),className:"text-cyan-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-white font-medium",children:"本地存储"}),(0,s.jsx)("div",{className:"text-gray-400 text-xs",children:"保存在浏览器本地，快速访问"})]})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-3 p-3 bg-gray-700/30 rounded-lg cursor-pointer hover:bg-gray-700/50 transition-colors",children:[(0,s.jsx)("input",{type:"radio",name:"saveLocation",value:"cloud",checked:"cloud"===em,onChange:e=>ex(e.target.value),className:"text-cyan-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-white font-medium",children:"云端存储"}),(0,s.jsx)("div",{className:"text-gray-400 text-xs",children:"保存到云端，跨设备同步"})]})]}),(0,s.jsxs)("label",{className:"flex items-center space-x-3 p-3 bg-gray-700/30 rounded-lg cursor-pointer hover:bg-gray-700/50 transition-colors",children:[(0,s.jsx)("input",{type:"radio",name:"saveLocation",value:"both",checked:"both"===em,onChange:e=>ex(e.target.value),className:"text-cyan-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-white font-medium",children:"本地+云端"}),(0,s.jsx)("div",{className:"text-gray-400 text-xs",children:"同时保存到本地和云端，双重保障"})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,s.jsx)("button",{onClick:()=>er(!1),className:"px-4 py-2 bg-gray-600 hover:bg-gray-500 rounded-lg text-white transition-colors",children:"取消"}),(0,s.jsx)("button",{onClick:()=>{localStorage.setItem("mindpulse-save-location",em),eu(em),er(!1),ee(!0),en(eV())},className:"px-4 py-2 bg-gradient-to-r from-cyan-500 to-purple-500 hover:from-cyan-400 hover:to-purple-400 rounded-lg text-white transition-colors",children:"确定并保存"})]})]})}),eL.show&&(0,s.jsx)("div",{className:(0,C.W)("fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-lg backdrop-blur-xl transition-all duration-300","success"===eL.type?"bg-green-500/20 border border-green-500/50 text-green-400":"bg-red-500/20 border border-red-500/50 text-red-400"),children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:["success"===eL.type?(0,s.jsx)(S.Z,{className:"w-5 h-5"}):(0,s.jsx)(k.Z,{className:"w-5 h-5"}),(0,s.jsx)("span",{className:"font-medium",children:eL.message}),(0,s.jsx)("button",{onClick:()=>eR(e=>({...e,show:!1})),className:"ml-2 hover:opacity-70 transition-opacity",children:(0,s.jsx)(_.Z,{className:"w-4 h-4"})})]})})]})}}}]);