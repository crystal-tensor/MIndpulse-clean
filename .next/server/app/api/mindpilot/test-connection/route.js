"use strict";(()=>{var e={};e.id=261,e.ids=[261],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},5260:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>x,patchFetch:()=>y,requestAsyncStorage:()=>g,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>w});var a={};s.r(a),s.d(a,{POST:()=>c});var o=s(9303),n=s(8716),r=s(670),i=s(7070);async function c(e){try{let t;let{provider:s,model:a,apiKey:o,baseUrl:n}=await e.json();if(!s||!a||!o)return i.NextResponse.json({error:"缺少必要参数"},{status:400});switch(s){case"openai":t=await p(o,a,n);break;case"deepseek":t=await u(o,a,n);break;case"claude":t=await l(o,a,n);break;case"gemini":t=await m(o,a,n);break;case"tongyi":t=await d(o,a,n);break;default:return i.NextResponse.json({error:"不支持的模型提供商"},{status:400})}return i.NextResponse.json({success:!0,message:"连接测试成功",details:t})}catch(e){return console.error("连接测试失败:",e),i.NextResponse.json({error:"连接测试失败",details:e instanceof Error?e.message:"未知错误"},{status:500})}}async function p(e,t,s){let a=await fetch(s||"https://api.openai.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:[{role:"user",content:'测试连接，请回复"连接成功"'}],max_tokens:10,temperature:.1})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(`OpenAI API错误: ${a.status} - ${e.error?.message||a.statusText}`)}let o=await a.json();return{model:o.model,usage:o.usage,response:o.choices[0]?.message?.content}}async function u(e,t,s){let a=await fetch(s||"https://api.deepseek.com/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,messages:[{role:"user",content:'测试连接，请回复"连接成功"'}],max_tokens:10,temperature:.1})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(`DeepSeek API错误: ${a.status} - ${e.error?.message||a.statusText}`)}let o=await a.json();return{model:o.model,usage:o.usage,response:o.choices[0]?.message?.content}}async function l(e,t,s){let a=await fetch(s||"https://api.anthropic.com/v1/messages",{method:"POST",headers:{"x-api-key":e,"Content-Type":"application/json","anthropic-version":"2023-06-01"},body:JSON.stringify({model:t,max_tokens:10,messages:[{role:"user",content:'测试连接，请回复"连接成功"'}]})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(`Claude API错误: ${a.status} - ${e.error?.message||a.statusText}`)}let o=await a.json();return{model:o.model,usage:o.usage,response:o.content[0]?.text}}async function m(e,t,s){let a=s||`https://generativelanguage.googleapis.com/v1/models/${t}:generateContent?key=${e}`,o=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({contents:[{parts:[{text:'测试连接，请回复"连接成功"'}]}],generationConfig:{maxOutputTokens:10,temperature:.1}})});if(!o.ok){let e=await o.json().catch(()=>({}));throw Error(`Gemini API错误: ${o.status} - ${e.error?.message||o.statusText}`)}let n=await o.json();return{model:t,response:n.candidates[0]?.content?.parts[0]?.text}}async function d(e,t,s){let a=await fetch(s||"https://dashscope.aliyuncs.com/api/v1/services/aigc/text-generation/generation",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify({model:t,input:{messages:[{role:"user",content:'测试连接，请回复"连接成功"'}]},parameters:{max_tokens:10,temperature:.1}})});if(!a.ok){let e=await a.json().catch(()=>({}));throw Error(`通义千问 API错误: ${a.status} - ${e.message||a.statusText}`)}let o=await a.json();return{model:t,usage:o.usage,response:o.output?.text}}let h=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/mindpilot/test-connection/route",pathname:"/api/mindpilot/test-connection",filename:"route",bundlePath:"app/api/mindpilot/test-connection/route"},resolvedPagePath:"/Users/danielcrystal/work/MindPulse-Clean/app/api/mindpilot/test-connection/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:g,staticGenerationAsyncStorage:w,serverHooks:f}=h,x="/api/mindpilot/test-connection/route";function y(){return(0,r.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:w})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[276,972],()=>s(5260));module.exports=a})();